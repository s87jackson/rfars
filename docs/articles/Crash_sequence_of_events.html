<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Crash Sequence of Events • rfars</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Crash Sequence of Events">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rfars</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Counts.html">Counts</a></li>
    <li><a class="dropdown-item" href="../articles/Crash_sequence_of_events.html">Crash Sequence of Events</a></li>
    <li><a class="dropdown-item" href="../articles/Searchable_Codebooks.html">Searchable Codebooks</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/s87jackson/rfars/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Crash Sequence of Events</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/s87jackson/rfars/blob/HEAD/vignettes/Crash_sequence_of_events.Rmd" class="external-link"><code>vignettes/Crash_sequence_of_events.Rmd</code></a></small>
      <div class="d-none name"><code>Crash_sequence_of_events.Rmd</code></div>
    </div>

    
    
<p>This vignette explores the <strong>vsoe</strong> (Vehicle Sequence of
Events) data to visualize crash sequence patterns.</p>
<p><strong>vsoe</strong> is one of three event-based data files, the
others being <strong>cevent</strong> and <strong>vevent</strong>.
According to the <a href="https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/813436" class="external-link">CRSS
Analytical User’s Manual</a>, <strong>vevent</strong> “has the same data
elements as the <strong>cevent</strong> data file” plus “a data element
that records the sequential event number for each vehicle,” and the
<strong>vsoe</strong> file “has a subset of the data elements contained
in the <strong>Vevent</strong> data file (it is a simplified
<strong>vevent</strong> data file)” (p. 16). <code>rfars</code>
therefore omits <strong>cevent</strong> and <strong>vevent</strong>.</p>
<p>First we get one year of data, and filter to the southern region for
simplicity.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu">rfars</span><span class="fu">::</span><span class="fu"><a href="../reference/get_gescrss.html">get_gescrss</a></span><span class="op">(</span>years<span class="op">=</span><span class="fl">2021</span>, regions <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✓ 2021 data downloaded</span></span>
<span><span class="co">#&gt; Preparing raw data files...</span></span>
<span><span class="co">#&gt; ✓ Accident file processed</span></span>
<span><span class="co">#&gt; ✓ Vehicle file processed</span></span>
<span><span class="co">#&gt; ✓ Person file processed</span></span>
<span><span class="co">#&gt; ✓ Weather file(s) processed</span></span>
<span><span class="co">#&gt; ✓ Crash risk factors file processed</span></span>
<span><span class="co">#&gt; ✓ Vehicle-level files processed</span></span>
<span><span class="co">#&gt; ✓ PBtype file processed</span></span>
<span><span class="co">#&gt; ✓ SafetyEq file processed</span></span>
<span><span class="co">#&gt; ✓ Person-level files processed</span></span>
<span><span class="co">#&gt; ✓ Flat file constructed</span></span>
<span><span class="co">#&gt; ✓ Multi_acc file constructed</span></span>
<span><span class="co">#&gt; ✓ Multi_veh file constructed</span></span>
<span><span class="co">#&gt; ✓ Multi_per file constructed</span></span>
<span><span class="co">#&gt; ✓ SOE file constructed</span></span>
<span><span class="co">#&gt; ✓ Prepared files saved in C:/Users/STEVEJ~1/AppData/Local/Temp/RtmpAz6rnI/GESCRSS data/prepd/2021</span></span>
<span><span class="co">#&gt; ✓ Codebook file saved in C:/Users/STEVEJ~1/AppData/Local/Temp/RtmpAz6rnI/GESCRSS data/prepd/</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">my_events</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">events</span></span></code></pre></div>
<p>The <strong>Vsoe</strong> data is stored in the <code>events</code>
tibble of the object returned by <code><a href="../reference/get_gescrss.html">get_gescrss()</a></code>. Here we see
the top 10 individual events:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_events</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">soe</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
soe
</th>
<th style="text-align:right;">
n
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Motor Vehicle In-Transport
</td>
<td style="text-align:right;">
47028
</td>
</tr>
<tr>
<td style="text-align:left;">
Ran Off Roadway - Right
</td>
<td style="text-align:right;">
4014
</td>
</tr>
<tr>
<td style="text-align:left;">
Ran Off Roadway - Left
</td>
<td style="text-align:right;">
2977
</td>
</tr>
<tr>
<td style="text-align:left;">
Parked Motor Vehicle
</td>
<td style="text-align:right;">
2044
</td>
</tr>
<tr>
<td style="text-align:left;">
Rollover/Overturn
</td>
<td style="text-align:right;">
1791
</td>
</tr>
<tr>
<td style="text-align:left;">
Cross Centerline
</td>
<td style="text-align:right;">
1475
</td>
</tr>
<tr>
<td style="text-align:left;">
Tree (Standing Only)
</td>
<td style="text-align:right;">
1206
</td>
</tr>
<tr>
<td style="text-align:left;">
Pedestrian
</td>
<td style="text-align:right;">
1202
</td>
</tr>
<tr>
<td style="text-align:left;">
Ditch
</td>
<td style="text-align:right;">
932
</td>
</tr>
<tr>
<td style="text-align:left;">
Utility Pole/Light Support
</td>
<td style="text-align:right;">
770
</td>
</tr>
</tbody>
</table>
<p>We can also see the top 10 most common sequences:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_events</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">aoi</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"veventnum"</span>, values_from <span class="op">=</span> <span class="st">"soe"</span>, values_fill <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>              names_prefix <span class="op">=</span> <span class="st">"event"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"event"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by_all.html" class="external-link">group_by_all</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">event1</span>, <span class="va">event2</span>, <span class="va">n</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
event1
</th>
<th style="text-align:left;">
event2
</th>
<th style="text-align:right;">
n
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Motor Vehicle In-Transport
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
38851
</td>
</tr>
<tr>
<td style="text-align:left;">
Motor Vehicle In-Transport
</td>
<td style="text-align:left;">
Motor Vehicle In-Transport
</td>
<td style="text-align:right;">
2248
</td>
</tr>
<tr>
<td style="text-align:left;">
Parked Motor Vehicle
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
1027
</td>
</tr>
<tr>
<td style="text-align:left;">
Pedestrian
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
913
</td>
</tr>
<tr>
<td style="text-align:left;">
Pedalcyclist
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
592
</td>
</tr>
<tr>
<td style="text-align:left;">
Live Animal
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
543
</td>
</tr>
<tr>
<td style="text-align:left;">
Cross Centerline
</td>
<td style="text-align:left;">
Motor Vehicle In-Transport
</td>
<td style="text-align:right;">
392
</td>
</tr>
<tr>
<td style="text-align:left;">
Ran Off Roadway - Right
</td>
<td style="text-align:left;">
Parked Motor Vehicle
</td>
<td style="text-align:right;">
269
</td>
</tr>
<tr>
<td style="text-align:left;">
Motor Vehicle In-Transport
</td>
<td style="text-align:left;">
Rollover/Overturn
</td>
<td style="text-align:right;">
221
</td>
</tr>
<tr>
<td style="text-align:left;">
Motor Vehicle In-Transport Strikes or is Struck by Cargo, Persons or
Objects Set-in-Motion from/by Another Motor Vehicle In Transport
</td>
<td style="text-align:left;">
x
</td>
<td style="text-align:right;">
187
</td>
</tr>
</tbody>
</table>
<p>Below we consider all state transitions - the transition from one
event to the next in the sequence. For example, the sequence A-B-C-D has
three transitions: A to B, B to C, and C to D. The graph below shows a
subset of the more common transitions in the crash sequences. It is
interpreted as follows: the event listed on the x-axis (top) was
followed by the event listed on the y-axis. The percentage shown at the
graphical intersection represents the percentage of transitions from one
event (x) to another event (y). For example, ‘Fence’ was followed by
‘Tree (Standing Only)’ in 21% of sequences. Note that we have added a
state labelled ‘Pre-Crash’ to help account for sequences with just one
event. Another notable takeaway is the large number of events that
precede Rollover/Overturn.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_events</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">casenum</span>, <span class="va">veh_no</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>event_to <span class="op">=</span> <span class="va">soe</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>event_from <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/shift.html" class="external-link">shift</a></span><span class="op">(</span><span class="va">event_to</span>, fill <span class="op">=</span> <span class="st">"Pre-Crash"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">event_from</span>, <span class="va">event_to</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">event_from</span>, <span class="va">event_to</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">event_from</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n_pct <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="va">n_from</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n_pct</span><span class="op">&gt;</span><span class="fl">.2</span>, <span class="va">n</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    event_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">event_from</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">30</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">event_from</span>, <span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span>, <span class="st">"..."</span><span class="op">)</span>, <span class="va">event_from</span><span class="op">)</span>,</span>
<span>    <span class="co">#event_to   = paste0(stringr::str_sub(event_to, 1, 30), "..."),</span></span>
<span>    event_to <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="va">event_to</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">event_from</span> <span class="op">!=</span> <span class="va">event_to</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">event_from</span>, y<span class="op">=</span><span class="va">event_to</span>, fill<span class="op">=</span><span class="va">n_pct</span>, label<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">(</span><span class="va">n_pct</span>, accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="co">#axis.text.x.bottom = element_text(angle=270, hjust = 0, vjust=.5),</span></span>
<span>      <span class="co">#legend.position = "none"</span></span>
<span>      <span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `year`, `casenum`, `veh_no`</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'event_from'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span></code></pre></div>
<p><img src="Crash_sequence_of_events_files/figure-html/unnamed-chunk-5-1.png" width="1152"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steve Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
